<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>GradeCash ‚Äî –¢–≤—ñ–π –∑–∞—Ä–æ–±—ñ—Ç–æ–∫</title>
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --accent: #00ff88;
            --text: #ffffff;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; padding-bottom: 80px; }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { text-align: center; color: var(--accent); }
        
        .stats-bar { display: flex; justify-content: space-around; margin-bottom: 20px; background: var(--card); padding: 15px; border-radius: 12px; }
        .stats-item { text-align: center; cursor: pointer; transition: 0.3s; }
        .stats-item:hover { color: var(--accent); }
        .stats-item span { display: block; font-size: 1.2em; font-weight: bold; }

        .day-card { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 15px; border-left: 5px solid var(--accent); }
        .day-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        
        input[type="number"] { background: #333; border: 1px solid #444; color: white; padding: 5px; border-radius: 5px; width: 50px; text-align: center; }
        .grades-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); gap: 10px; margin-top: 10px; }
        
        .finish-btn { width: 100%; padding: 15px; background: var(--accent); border: none; border-radius: 10px; color: black; font-weight: bold; font-size: 1.1em; cursor: pointer; margin-top: 20px; }
        
        .nav-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; padding: 10px 30px; border-radius: 20px; border: 1px solid var(--accent); cursor: pointer; color: white; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 100; text-align: center; }
        .modal-content { background: var(--card); padding: 30px; border-radius: 20px; border: 2px solid var(--accent); max-width: 80%; }
    </style>
</head>
<body>

<div class="container" id="main-page">
    <h1>GradeCash üí∏</h1>
    
    <div class="stats-bar">
        <div class="stats-item" onclick="alert('–ó–∞ —Ç–∏–∂–¥–µ–Ω—å: ' + (localStorage.getItem('weekTotal') || 0) + ' –≥—Ä–Ω')">–¢–∏–∂–¥–µ–Ω—å<span id="stat-week">0</span></div>
        <div class="stats-item" onclick="alert('–ó–∞ –º—ñ—Å—è—Ü—å: ' + (localStorage.getItem('monthTotal') || 0) + ' –≥—Ä–Ω')">–ú—ñ—Å—è—Ü—å<span id="stat-month">0</span></div>
        <div class="stats-item" onclick="alert('–ó–∞ —Ä—ñ–∫: ' + (localStorage.getItem('yearTotal') || 0) + ' –≥—Ä–Ω')">–†—ñ–∫<span id="stat-year">0</span></div>
    </div>

    <div id="days-container"></div>

    <button class="finish-btn" onclick="finishWeek()">–ó–ê–ö–Ü–ù–ß–ò–¢–ò –¢–ò–ñ–î–ï–ù–¨</button>
</div>

<button class="nav-btn" onclick="location.reload()">–ù–ê –ì–û–õ–û–í–ù–£</button>

<div id="resultModal" class="modal">
    <div class="modal-content">
        <h2 id="resultTitle"></h2>
        <p id="resultText"></p>
        <button class="finish-btn" onclick="closeModal()">–û–ö, –ù–û–í–ò–ô –¢–ò–ñ–î–ï–ù–¨</button>
    </div>
</div>

<script>
const days = ["–ü–æ–Ω–µ–¥—ñ–ª–æ–∫", "–í—ñ–≤—Ç–æ—Ä–æ–∫", "–°–µ—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä", "–ü'—è—Ç–Ω–∏—Ü—è"];
const rates = {12:300, 11:100, 10:25, 9:0, 8:0, 7:-25, 6:-100, 5:-300, 4:-300, 3:-300, 2:-500};

let data = JSON.parse(localStorage.getItem('gradeData')) || days.map(d => ({name: d, lessons: 0, grades: []}));

function init() {
    const container = document.getElementById('days-container');
    container.innerHTML = '';
    data.forEach((day, idx) => {
        const div = document.createElement('div');
        div.className = 'day-card';
        div.innerHTML = `
            <div class="day-header">
                <strong>${day.name}</strong>
                <label>–£—Ä–æ–∫—ñ–≤: <input type="number" min="0" max="10" value="${day.lessons}" onchange="updateLessons(${idx}, this.value)"></label>
            </div>
            <div class="grades-grid" id="grades-${idx}"></div>
        `;
        container.appendChild(div);
        renderGrades(idx);
    });
    updateStats();
}

function updateLessons(dayIdx, count) {
    data[dayIdx].lessons = parseInt(count) || 0;
    while(data[dayIdx].grades.length < count) data[dayIdx].grades.push("");
    data[dayIdx].grades = data[dayIdx].grades.slice(0, count);
    save();
    renderGrades(dayIdx);
}

function renderGrades(dayIdx) {
    const grid = document.getElementById(`grades-${dayIdx}`);
    grid.innerHTML = '';
    data[dayIdx].grades.forEach((grade, gIdx) => {
        const input = document.createElement('input');
        input.type = 'number';
        input.placeholder = '-';
        input.value = grade;
        input.onchange = (e) => {
            data[dayIdx].grades[gIdx] = parseInt(e.target.value) || "";
            save();
            updateStats();
        };
        grid.appendChild(input);
    });
}

function save() { localStorage.setItem('gradeData', JSON.stringify(data)); }

function calculateWeek() {
    return data.reduce((sum, day) => {
        return sum + day.grades.reduce((dSum, g) => dSum + (rates[g] || 0), 0);
    }, 0);
}

function updateStats() {
    const total = calculateWeek();
    document.getElementById('stat-week').innerText = total;
    document.getElementById('stat-month').innerText = localStorage.getItem('monthTotal') || 0;
    document.getElementById('stat-year').innerText = localStorage.getItem('yearTotal') || 0;
}

function finishWeek() {
    const total = calculateWeek();
    let title = "", text = `–í—ñ—Ç–∞—é! –ó–∞ —Ü–µ–π —Ç–∏–∂–¥–µ–Ω—å –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ ${total} –≥—Ä–Ω.`;
    
    if(total < 1000) title = "–ú–æ–∂–Ω–∞ –±—É–ª–æ —ñ –±—ñ–ª—å—à–µ üòï";
    else if(total < 1700) title = "–î–æ–±—Ä–µ! üëç";
    else title = "–ë–ï–ó–î–û–ì–ê–ù–ù–û! üèÜ";

    document.getElementById('resultTitle').innerText = title;
    document.getElementById('resultText').innerText = text;
    document.getElementById('resultModal').style.display = 'flex';

    // –û–Ω–æ–≤–ª—é—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é
    localStorage.setItem('weekTotal', total);
    localStorage.setItem('monthTotal', (parseInt(localStorage.getItem('monthTotal') || 0) + total));
    localStorage.setItem('yearTotal', (parseInt(localStorage.getItem('yearTotal') || 0) + total));
}

function closeModal() {
    data.forEach(day => day.grades = day.grades.fill(""));
    save();
    location.reload();
}

init();
</script>
</body>
</html>
